const e=()=>{let e={};const t={},a={},l=[];let n=[],r=[];const s=t=>{e.debug&&console.log(t)},i=e=>e&&"object"==typeof e&&!Array.isArray(e),d=(e,...t)=>{if(!t.length)return e;const a=t.shift();if(i(e)&&i(a))for(const t in a)i(a[t])?(e[t]||Object.assign(e,{[t]:{}}),d(e[t],a[t])):Object.assign(e,{[t]:a[t]});return d(e,...t)},o=(e,t)=>{let a=e.querySelectorAll(t);return Array.prototype.slice.call(a)},m=e=>{let t=!1;for(let a=0;a<e.childNodes.length;a++)if("SECTION"==e.childNodes[a].tagName){t=!0;break}return t},c=e=>document.createRange().createContextualFragment(e).firstElementChild,u=(e,t,a)=>{let l=document.querySelector("head"),n=document.createElement("link");n.rel="stylesheet",n.href=e;let r=()=>{"function"==typeof a&&(a.call(),a=null)};n.onload=r,n.onreadystatechange=function(){"loaded"===this.readyState&&r()},l.appendChild(n)},h=(e,t)=>{let a=0;for(let l=0;l<=e.length;l++)e[l]==t&&a++;return a},g=e=>{let a=e*t.userScale;t.viewport.style.setProperty("--simplemenu-scale",a.toFixed(3))};const f=()=>{s("Preparing menubars");let a=o(t.viewport,`.${e.menubarclass}`)?o(t.viewport,`.${e.menubarclass}`):[];if(e.barhtml.header){let l=c(e.barhtml.header);a.push(l),t.slides.before(l)}if(e.barhtml.footer){let l=c(e.barhtml.footer);a.push(l),t.slides.after(l)}a.length?(g(t.deck.getScale()),a.forEach(((a,l)=>{let n=((e,t)=>{for(var a=document.getElementsByTagName("*"),l=0;l<a.length;++l){if(a[l]===e)return!0;if(a[l]===t)return!1}})(a,t.slides)?"top":"bottom";a.classList.add(n),a.id||(a.id=`${e.menubarclass}${n}`),a.classList.add("ready")})),t.menubars=a):console.log("There are no menubars. You can still use Simplemenu to populate empty menus like in an Agenda or Table Of Contents.")},p=()=>{s("Preparing menus");let i=(()=>{const a=t.matchString;let l=o(t.viewport,`.${e.menuclass}`)?o(t.viewport,`.${e.menuclass}`):[],n=[],r=[];return!!l.length&&(l.forEach((t=>{t.getElementsByTagName("li").length<1?(t.setAttribute("data-simplemenu-auto",""),n.push(t)):("data-name"!=e.selectby&&"name"!=e.selectby||o(t,`.${e.menuclass} ${e.activeelement}`).forEach((e=>{if(!e.dataset[a]){let t=e.textContent||e.querySelector("a").textContent;e.setAttribute(`data-${a}`,t)}})),r.push(t))})),{automenus:n,manualmenus:r})})();if(!i||i&&!i.automenus)console.log("There are no menus. Please add one or more menus manually or through the 'barhtml' option.");else{if(i.automenus.length>=1&&a.namedvisible.length>=1){let r=[];const s=a.namedvisible.map((e=>{let a=e.dataset[t.matchString],n=e.dataset.name||e.getAttribute("name")||e.id,s=e.id||n.toLowerCase().replace(/\W/g,"");r.push(s),t.quarto&&(s=l.find((e=>e.match===a)).id);let i=h(r,s)>1?`-${h(r,s)}`:"",d=t.quarto?s:s+i,o=` data-${t.matchString}="${a}"`,m=e.getAttribute("name")?` name="${e.getAttribute("name")}"`:"";return`<li><a href="#/${d}"${e.getAttribute(t.langattribute)?` ${t.langattribute}="${e.getAttribute(t.langattribute)}"`:""}${m}${o}>${n}</a></li>`})).reduce(((e,a)=>t.rtl?a+e:e+a));i.automenus.forEach((e=>{e.innerHTML=s})),n=i.automenus.map((t=>Array.from(t.querySelectorAll(e.activeelement)))).flat()}i.manualmenus.length>=1&&(r=i.manualmenus.map((t=>Array.from(t.querySelectorAll(e.activeelement)))).flat(),r.forEach((e=>{let a="a"==e.tagName?e:e.querySelector("a");if("#"===a.getAttribute("href")){let l=e.dataset[t.matchString].toLowerCase().replace(/\W/g,"");a.href=`#/${l}`}})))}},b=n=>((()=>{s("Preparing slides"),a.all=o(t.viewport,"section"),a.all.forEach((e=>{!e.parentNode.dataset.name&&e.dataset&&e.dataset.stackName&&(e.parentNode.dataset.name=e.dataset.stackName),e.dataset&&e.dataset[t.matchString]&&"false"==e.dataset[t.matchString]&&e.dataset.name&&delete e.dataset.name})),a.top=a.all.filter((e=>e.parentNode.classList.contains("slides")&&!(e.dataset[t.matchString]&&"false"==e.dataset[t.matchString]))),a.named=a.top.filter((e=>e.dataset.name||e.getAttribute("name"))),a.namedvisible=a.named.filter((e=>"hidden"!=e.dataset.visibility));let n=[];a.named.forEach((e=>{let a=e.dataset.name||e.getAttribute("name");n.push(a);let l=a&&h(n,a)>1?`-${h(n,a)}`:null,r=l?a+l:a;if(e.setAttribute(`data-${t.matchString}`,r),m(e)||e.id){if(m(e)){let t=o(e,"section").filter((e=>"hidden"!=e.dataset.visibility))[0];t&&!t.id&&(t.id=r.toLowerCase().replace(/\W/g,""),e.id==t.id&&e.removeAttribute("id"))}}else e.id=r.toLowerCase().replace(/\W/g,"")}));let r=null,i=null;a.regular=a.all.filter((e=>!m(e)&&"hidden"!=e.dataset.visibility)),a.regular.forEach(((a,n)=>{let s=m(a.parentNode)&&"SECTION"==a.parentNode.tagName,d=s?a.parentNode:a,o=d.dataset.name,c=d.getAttribute("name"),u=d.getAttribute(t.langattribute)?d.getAttribute(t.langattribute):null,h=a.parentNode.id?a.parentNode.id:null,g=a.id?a.id:s?h:null,f=d.dataset[t.matchString];f&&(r=f),(g||"false"==f)&&(i=n),e.flat&&"false"!=f&&(f=r),"false"==f&&(f=null),"false"==o&&(o=null);let p={index:n,...a&&{section:a},...o&&{dataname:o},...c&&{name:c},...g&&{id:g},...f&&{match:f},...i&&{currentid:i},...u&&{dataintl:u}};l.push(p)}))})(),f(),p(),new URLSearchParams(window.location.search).has("print-pdf")&&l.forEach((e=>{let t=e.section,a=document.createElement("div");var l;a.classList.add("datainfo"),l=a,[...t.attributes].filter((e=>e.nodeName.indexOf("data")>-1)).forEach((e=>{l.setAttribute(e.nodeName,e.nodeValue)})),["match","name","dataname","currentid","id","dataintl"].forEach((t=>{e[t]&&(a.dataset[t]=e[t])})),t.appendChild(a)})),setTimeout(n,0)),y=(a,n)=>{let r=a.parentNode.hasAttribute("data-simplemenu-auto")?"auto":"manual",s=n.match?n.match:null;if("manual"==r&&(s="id"==e.selectby?n.id?n.id:n.currentid?l[n.currentid].id:null:"name"==e.selectby?n.name:n.dataname),s){let l=a.dataset[t.matchString]||a.querySelector("a").dataset[t.matchString];if("id"==e.selectby&&"manual"==r){let e=a.href||a.querySelector("a").href;l=e?e.substring(e.lastIndexOf("/")+1):""}"data-name"==e.selectby&&"manual"==r&&(s=n.dataname?n.dataname:null),l&&l==s?a.classList.add(e.activeclass):a.classList.remove(e.activeclass)}else a.classList.remove(e.activeclass)},v=i=>{i&&"ready"==i.type&&(s(l),["controls","slide-number"].forEach((e=>{let a=t.deck.getRevealElement().querySelector(`.reveal > .${e}`),l=t.deck.getRevealElement().querySelector(`.reveal > * .${e}`);a&&l&&((e,t)=>{let a=t.classList;t.parentNode.replaceChild(e,t),e.classList=a})(a,l)}))),!i||"ready"!=i.type&&"slidechanged"!=i.type||(e=>{const t=a.regular.indexOf(e.currentSlide);let s=l[t];n.filter((e=>{y(e,s)})),r.filter((e=>{y(e,s)}))})(i),i&&"pdf-ready"==i.type&&(a=>{let l=o(t.viewport,".slides .pdf-page"),n=!1;t.menubars&&t.menubars.forEach((e=>{n=!!e.getElementsByClassName("slide-number")})),l.forEach((a=>{let l=a.getElementsByClassName("datainfo")[0],r={};r.name=l.dataset.name,r.dataname=l.dataset.dataname,r.currentid=l.dataset.currentid,r.match=l.dataset.match,r.id=l.dataset.id,l.dataset.state&&l.dataset.state.split(" ").forEach((e=>{a.classList.add(e),t.deck.getRevealElement().closest(".reveal-viewport").classList.remove(e)})),n&&a.getElementsByClassName("slide-number").length>0&&(a.getElementsByClassName("slide-number")[0].style.display="none"),t.menubars&&t.menubars.forEach((t=>{let l=t.cloneNode(!0);a.appendChild(l),o(l,`.${e.menuclass} ${e.activeelement}`).forEach((e=>{y(e,r)}));let n=a.querySelector(`.${e.menubarclass} .slide-number`),s=a.querySelector(":scope > .slide-number");n&&s&&(n.textContent=s.textContent)}))})),t.menubars&&t.menubars.forEach((e=>{e.parentNode.removeChild(e)}))})()},E=(e,a,l)=>{e.configure({hash:!0}),t.deck=e,t.viewport="BODY"==e.getRevealElement().tagName?document:e.getRevealElement(),t.slides=e.getSlidesElement(),t.langattribute=!!e.getConfig().internation&&(e.getConfig().internation.langattribute?e.getConfig().internation.langattribute:"data-i18n"),t.rtl=e.getConfig().rtl,t.quarto=!(!document.querySelector("[name=generator]")||!document.querySelector("[name=generator]").content.includes("quarto")),t.matchString="sm",t.userScale=a.scale,e.addEventListener("ready",v,!1),e.addEventListener("slidechanged",v,!1),e.addEventListener("pdf-ready",v,!1),e.addEventListener("resize",(({scale:e})=>g(e)),!1);const n=a.csspath?a.csspath:`${(e=>{let t,a=document.querySelector(`script[src$="${e}"]`);return t=a?a.getAttribute("src").slice(0,-1*e.length):import.meta.url.slice(0,import.meta.url.lastIndexOf("/")+1),t})(l)}simplemenu.css`||"plugin/simplemenu/simplemenu.css";return new Promise((e=>{if(!1===a.csspath)return b(e);u(n,0,(async()=>b(e)))}))};return{id:"simplemenu",init:t=>{e=t.getConfig().simplemenu||{},e=d({menubarclass:"menubar",menuclass:"menu",activeclass:"active",activeelement:"li",selectby:"id",barhtml:{header:"",footer:""},flat:!1,scale:.67,csspath:""},e);let a=!1,l="";return"id"!==e.selectby&&"data-name"!==e.selectby&&"name"!==e.selectby&&(a=!0,l='The selectby option can be only "id",  "data-name" or "name".'),a?(console.log("Simplemenu did not load:"),console.log(l),!1):E(t,e,"simplemenu.js")}}};export{e as default};
