!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).RevealSimpleMenu=t()}(this,(function(){"use strict";var e="undefined"!=typeof document?document.currentScript:null;return()=>{let t={};const a={},n={},l=[];let r=[],s=[];const i=e=>{t.debug&&console.log(e)},d=e=>e&&"object"==typeof e&&!Array.isArray(e),o=(e,...t)=>{if(!t.length)return e;const a=t.shift();if(d(e)&&d(a))for(const t in a)d(a[t])?(e[t]||Object.assign(e,{[t]:{}}),o(e[t],a[t])):Object.assign(e,{[t]:a[t]});return o(e,...t)},m=(e,t)=>{let a=e.querySelectorAll(t);return Array.prototype.slice.call(a)},c=e=>{let t=!1;for(let a=0;a<e.childNodes.length;a++)if("SECTION"==e.childNodes[a].tagName){t=!0;break}return t},u=e=>document.createRange().createContextualFragment(e).firstElementChild,f=(e,t,a)=>{let n=document.querySelector("head"),l=document.createElement("link");l.rel="stylesheet",l.href=e;let r=()=>{"function"==typeof a&&(a.call(),a=null)};l.onload=r,l.onreadystatechange=function(){"loaded"===this.readyState&&r()},n.appendChild(l)},h=(e,t)=>{let a=0;for(let n=0;n<=e.length;n++)e[n]==t&&a++;return a},p=e=>{let t=e*a.userScale;a.viewport.style.setProperty("--simplemenu-scale",t.toFixed(3))};const g=()=>{i("Preparing menubars");let e=m(a.viewport,`.${t.menubarclass}`)?m(a.viewport,`.${t.menubarclass}`):[];if(t.barhtml.header){let n=u(t.barhtml.header);e.push(n),a.slides.before(n)}if(t.barhtml.footer){let n=u(t.barhtml.footer);e.push(n),a.slides.after(n)}e.length?(p(a.deck.getScale()),e.forEach(((e,n)=>{let l=((e,t)=>{for(var a=document.getElementsByTagName("*"),n=0;n<a.length;++n){if(a[n]===e)return!0;if(a[n]===t)return!1}})(e,a.slides)?"top":"bottom";e.classList.add(l),e.id||(e.id=`${t.menubarclass}${l}`),e.classList.add("ready")})),a.menubars=e):console.log("There are no menubars. You can still use Simplemenu to populate empty menus like in an Agenda or Table Of Contents.")},b=()=>{i("Preparing menus");let e=(()=>{const e=a.matchString;let n=m(a.viewport,`.${t.menuclass}`)?m(a.viewport,`.${t.menuclass}`):[],l=[],r=[];return!!n.length&&(n.forEach((a=>{a.getElementsByTagName("li").length<1?(a.setAttribute("data-simplemenu-auto",""),l.push(a)):("data-name"!=t.selectby&&"name"!=t.selectby||m(a,`.${t.menuclass} ${t.activeelement}`).forEach((t=>{if(!t.dataset[e]){let a=t.textContent||t.querySelector("a").textContent;t.setAttribute(`data-${e}`,a)}})),r.push(a))})),{automenus:l,manualmenus:r})})();if(!e||e&&!e.automenus)console.log("There are no menus. Please add one or more menus manually or through the 'barhtml' option.");else{if(e.automenus.length>=1&&n.namedvisible.length>=1){let s=[];const i=n.namedvisible.map((e=>{let t=e.dataset[a.matchString],n=e.dataset.name||e.getAttribute("name")||e.id,r=e.id||n.toLowerCase().replace(/\W/g,"");s.push(r),a.quarto&&(r=l.find((e=>e.match===t)).id);let i=h(s,r)>1?`-${h(s,r)}`:"",d=a.quarto?r:r+i,o=` data-${a.matchString}="${t}"`,m=e.getAttribute("name")?` name="${e.getAttribute("name")}"`:"";return`<li><a href="#/${d}"${e.getAttribute(a.langattribute)?` ${a.langattribute}="${e.getAttribute(a.langattribute)}"`:""}${m}${o}>${n}</a></li>`})).reduce(((e,t)=>a.rtl?t+e:e+t));e.automenus.forEach((e=>{e.innerHTML=i})),r=e.automenus.map((e=>Array.from(e.querySelectorAll(t.activeelement)))).flat()}e.manualmenus.length>=1&&(s=e.manualmenus.map((e=>Array.from(e.querySelectorAll(t.activeelement)))).flat(),s.forEach((e=>{let t="a"==e.tagName?e:e.querySelector("a");if("#"===t.getAttribute("href")){let n=e.dataset[a.matchString].toLowerCase().replace(/\W/g,"");t.href=`#/${n}`}})))}},y=e=>((()=>{i("Preparing slides"),n.all=m(a.viewport,"section"),n.all.forEach((e=>{!e.parentNode.dataset.name&&e.dataset&&e.dataset.stackName&&(e.parentNode.dataset.name=e.dataset.stackName),e.dataset&&e.dataset[a.matchString]&&"false"==e.dataset[a.matchString]&&e.dataset.name&&delete e.dataset.name})),n.top=n.all.filter((e=>e.parentNode.classList.contains("slides")&&!(e.dataset[a.matchString]&&"false"==e.dataset[a.matchString]))),n.named=n.top.filter((e=>e.dataset.name||e.getAttribute("name"))),n.namedvisible=n.named.filter((e=>"hidden"!=e.dataset.visibility));let e=[];n.named.forEach((t=>{let n=t.dataset.name||t.getAttribute("name");e.push(n);let l=n&&h(e,n)>1?`-${h(e,n)}`:null,r=l?n+l:n;if(t.setAttribute(`data-${a.matchString}`,r),c(t)||t.id){if(c(t)){let e=m(t,"section").filter((e=>"hidden"!=e.dataset.visibility))[0];e&&!e.id&&(e.id=r.toLowerCase().replace(/\W/g,""),t.id==e.id&&t.removeAttribute("id"))}}else t.id=r.toLowerCase().replace(/\W/g,"")}));let r=null,s=null;n.regular=n.all.filter((e=>!c(e)&&"hidden"!=e.dataset.visibility)),n.regular.forEach(((e,n)=>{let i=c(e.parentNode)&&"SECTION"==e.parentNode.tagName,d=i?e.parentNode:e,o=d.dataset.name,m=d.getAttribute("name"),u=d.getAttribute(a.langattribute)?d.getAttribute(a.langattribute):null,f=e.parentNode.id?e.parentNode.id:null,h=e.id?e.id:i?f:null,p=d.dataset[a.matchString];p&&(r=p),(h||"false"==p)&&(s=n),t.flat&&"false"!=p&&(p=r),"false"==p&&(p=null),"false"==o&&(o=null);let g={index:n,...e&&{section:e},...o&&{dataname:o},...m&&{name:m},...h&&{id:h},...p&&{match:p},...s&&{currentid:s},...u&&{dataintl:u}};l.push(g)}))})(),g(),b(),new URLSearchParams(window.location.search).has("print-pdf")&&l.forEach((e=>{let t=e.section,a=document.createElement("div");var n;a.classList.add("datainfo"),n=a,[...t.attributes].filter((e=>e.nodeName.indexOf("data")>-1)).forEach((e=>{n.setAttribute(e.nodeName,e.nodeValue)})),["match","name","dataname","currentid","id","dataintl"].forEach((t=>{e[t]&&(a.dataset[t]=e[t])})),t.appendChild(a)})),setTimeout(e,0)),v=(e,n)=>{let r=e.parentNode.hasAttribute("data-simplemenu-auto")?"auto":"manual",s=n.match?n.match:null;if("manual"==r&&(s="id"==t.selectby?n.id?n.id:n.currentid?l[n.currentid].id:null:"name"==t.selectby?n.name:n.dataname),s){let l=e.dataset[a.matchString]||e.querySelector("a").dataset[a.matchString];if("id"==t.selectby&&"manual"==r){let t=e.href||e.querySelector("a").href;l=t?t.substring(t.lastIndexOf("/")+1):""}"data-name"==t.selectby&&"manual"==r&&(s=n.dataname?n.dataname:null),l&&l==s?e.classList.add(t.activeclass):e.classList.remove(t.activeclass)}else e.classList.remove(t.activeclass)},S=e=>{e&&"ready"==e.type&&(i(l),["controls","slide-number"].forEach((e=>{let t=a.deck.getRevealElement().querySelector(`.reveal > .${e}`),n=a.deck.getRevealElement().querySelector(`.reveal > * .${e}`);t&&n&&((e,t)=>{let a=t.classList;t.parentNode.replaceChild(e,t),e.classList=a})(t,n)}))),!e||"ready"!=e.type&&"slidechanged"!=e.type||(e=>{const t=n.regular.indexOf(e.currentSlide);let a=l[t];r.filter((e=>{v(e,a)})),s.filter((e=>{v(e,a)}))})(e),e&&"pdf-ready"==e.type&&(e=>{let n=m(a.viewport,".slides .pdf-page"),l=!1;a.menubars&&a.menubars.forEach((e=>{l=!!e.getElementsByClassName("slide-number")})),n.forEach((e=>{let n=e.getElementsByClassName("datainfo")[0],r={};r.name=n.dataset.name,r.dataname=n.dataset.dataname,r.currentid=n.dataset.currentid,r.match=n.dataset.match,r.id=n.dataset.id,n.dataset.state&&n.dataset.state.split(" ").forEach((t=>{e.classList.add(t),a.deck.getRevealElement().closest(".reveal-viewport").classList.remove(t)})),l&&e.getElementsByClassName("slide-number").length>0&&(e.getElementsByClassName("slide-number")[0].style.display="none"),a.menubars&&a.menubars.forEach((a=>{let n=a.cloneNode(!0);e.appendChild(n),m(n,`.${t.menuclass} ${t.activeelement}`).forEach((e=>{v(e,r)}));let l=e.querySelector(`.${t.menubarclass} .slide-number`),s=e.querySelector(":scope > .slide-number");l&&s&&(l.textContent=s.textContent)}))})),a.menubars&&a.menubars.forEach((e=>{e.parentNode.removeChild(e)}))})()},E=(t,n,l)=>{t.configure({hash:!0}),a.deck=t,a.viewport="BODY"==t.getRevealElement().tagName?document:t.getRevealElement(),a.slides=t.getSlidesElement(),a.langattribute=!!t.getConfig().internation&&(t.getConfig().internation.langattribute?t.getConfig().internation.langattribute:"data-i18n"),a.rtl=t.getConfig().rtl,a.quarto=!(!document.querySelector("[name=generator]")||!document.querySelector("[name=generator]").content.includes("quarto")),a.matchString="sm",a.userScale=n.scale,t.addEventListener("ready",S,!1),t.addEventListener("slidechanged",S,!1),t.addEventListener("pdf-ready",S,!1),t.addEventListener("resize",(({scale:e})=>p(e)),!1);const r=n.csspath?n.csspath:`${(t=>{let a,n=document.querySelector(`script[src$="${t}"]`);return a=n?n.getAttribute("src").slice(0,-1*t.length):("undefined"==typeof document&&"undefined"==typeof location?require("url").pathToFileURL(__filename).href:"undefined"==typeof document?location.href:e&&"SCRIPT"===e.tagName.toUpperCase()&&e.src||new URL("simplemenu.js",document.baseURI).href).slice(0,("undefined"==typeof document&&"undefined"==typeof location?require("url").pathToFileURL(__filename).href:"undefined"==typeof document?location.href:e&&"SCRIPT"===e.tagName.toUpperCase()&&e.src||new URL("simplemenu.js",document.baseURI).href).lastIndexOf("/")+1),a})(l)}simplemenu.css`||"plugin/simplemenu/simplemenu.css";return new Promise((e=>{if(!1===n.csspath)return y(e);f(r,0,(async()=>y(e)))}))};return{id:"simplemenu",init:e=>{t=e.getConfig().simplemenu||{},t=o({menubarclass:"menubar",menuclass:"menu",activeclass:"active",activeelement:"li",selectby:"id",barhtml:{header:"",footer:""},flat:!1,scale:.67,csspath:""},t);let a=!1,n="";return"id"!==t.selectby&&"data-name"!==t.selectby&&"name"!==t.selectby&&(a=!0,n='The selectby option can be only "id",  "data-name" or "name".'),a?(console.log("Simplemenu did not load:"),console.log(n),!1):E(e,t,"simplemenu.js")}}}}));
